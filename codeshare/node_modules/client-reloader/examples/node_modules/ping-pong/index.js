
var serializer = require('stream-serializer')()
var Duplex     = require('duplex')

module.exports = function (interval) {
  var int
  var d = Duplex()
    .on('_data', function (ping) {
      this._data({pong: ping.ts, ts: Date.now()})
    })
    .on('_end', function () {
      clearInterval(int)
    })

  int = setInterval(function () {
    if(!d.paused)
      d._data({ping: true, ts: Date.now()})
  }, interval || 1e3)

  return serializer(d)
}
